(window.webpackJsonp=window.webpackJsonp||[]).push([[341],{Km9B:function(e,c,a){"use strict";a.r(c),a.d(c,"ScanQrConfirmationModule",(function(){return f}));var t=a("ofXK"),i=a("tyNb"),s=a("XNiG"),r=a("wd/R"),d=a("fXoL"),n=a("EnSQ"),o=a("L7Xq"),p=a("5IsW"),l=a("H9Rt"),v=a("TiA8"),S=a("Ygbc"),h=a("aa7p"),u=a("4bKs"),y=a("au7T"),D=a("Eioz");function b(e,c){if(1&e&&(d.ec(0,"div",17),d.ec(1,"ul",18),d.ec(2,"li",19),d.ec(3,"div",20),d.ec(4,"div",8),d.ec(5,"div",21),d.ec(6,"div",22),d.ec(7,"h6"),d.Sc(8),d.qc(9,"translate"),d.dc(),d.ec(10,"h5"),d.Sc(11),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(12,"li",19),d.ec(13,"div",20),d.ec(14,"div",8),d.ec(15,"div",21),d.ec(16,"div",22),d.ec(17,"h6"),d.Sc(18),d.qc(19,"translate"),d.dc(),d.ec(20,"h5"),d.Sc(21),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(22,"li",19),d.ec(23,"div",20),d.ec(24,"div",8),d.ec(25,"div",21),d.ec(26,"div",22),d.ec(27,"h6"),d.Sc(28),d.qc(29,"translate"),d.dc(),d.ec(30,"h5"),d.Sc(31),d.qc(32,"translate"),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(33,"li",19),d.ec(34,"div",20),d.ec(35,"div",8),d.ec(36,"div",21),d.ec(37,"div",22),d.ec(38,"h6"),d.Sc(39),d.qc(40,"translate"),d.dc(),d.ec(41,"h5"),d.Sc(42),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(43,"li",19),d.ec(44,"div",20),d.ec(45,"div",8),d.ec(46,"div",21),d.ec(47,"div",22),d.ec(48,"h6"),d.Sc(49),d.qc(50,"translate"),d.dc(),d.ec(51,"h5"),d.Zb(52,"img",23),d.Sc(53),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(54,"li",19),d.ec(55,"div",20),d.ec(56,"div",8),d.ec(57,"div",21),d.ec(58,"div",22),d.ec(59,"h6"),d.Sc(60),d.qc(61,"translate"),d.dc(),d.ec(62,"h5"),d.Sc(63),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc()),2&e){const e=d.pc();d.Mb(8),d.Tc(d.rc(9,13,"UPI_ID")),d.Mb(3),d.Uc("",e.DataService.selectedVpaDetailsPay.vpaDetails.paymentAddress," "),d.Mb(7),d.Tc(d.rc(19,15,"LINKED_ACCOUNT")),d.Mb(3),d.Uc("",e.DataService.selectedVpaDetailsPay.accountDetails.maskedAccountNumber," "),d.Mb(7),d.Tc(d.rc(29,17,"TO_PAYEE")),d.Mb(3),d.Vc("",d.rc(32,19,"UPI_ID")," : ",e.DataService.payeeObj.payeeUpiAddress,""),d.Mb(8),d.Tc(d.rc(40,21,"PAYEE_NAME")),d.Mb(3),d.Tc(e.DataService.payeeObj.payeeName),d.Mb(7),d.Tc(d.rc(50,23,"AMOUNT")),d.Mb(4),d.Uc(" ",e.payeeAmt," "),d.Mb(7),d.Tc(d.rc(61,25,"REMARKS")),d.Mb(3),d.Tc(e.DataService.upiPayRequest.remarks?e.DataService.upiPayRequest.remarks:"-")}}function m(e,c){if(1&e&&(d.ec(0,"div",17),d.ec(1,"ul",18),d.ec(2,"li",19),d.ec(3,"div",20),d.ec(4,"div",8),d.ec(5,"div",21),d.ec(6,"div",22),d.ec(7,"h6"),d.Sc(8),d.qc(9,"translate"),d.dc(),d.ec(10,"h5"),d.Sc(11),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(12,"li",19),d.ec(13,"div",20),d.ec(14,"div",8),d.ec(15,"div",21),d.ec(16,"div",22),d.ec(17,"h6"),d.Sc(18),d.qc(19,"translate"),d.dc(),d.ec(20,"h5"),d.Sc(21),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(22,"li",19),d.ec(23,"div",20),d.ec(24,"div",8),d.ec(25,"div",21),d.ec(26,"div",22),d.ec(27,"h6"),d.Sc(28),d.qc(29,"translate"),d.dc(),d.ec(30,"h5"),d.Sc(31),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(32,"li",19),d.ec(33,"div",20),d.ec(34,"div",8),d.ec(35,"div",21),d.ec(36,"div",22),d.ec(37,"h6"),d.Sc(38),d.qc(39,"translate"),d.dc(),d.ec(40,"h5"),d.Sc(41),d.dc(),d.ec(42,"h5"),d.Sc(43),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(44,"li",19),d.ec(45,"div",20),d.ec(46,"div",8),d.ec(47,"div",21),d.ec(48,"div",22),d.ec(49,"h6"),d.Sc(50),d.qc(51,"translate"),d.dc(),d.ec(52,"h5"),d.Sc(53),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(54,"li",19),d.ec(55,"div",20),d.ec(56,"div",8),d.ec(57,"div",21),d.ec(58,"div",22),d.ec(59,"h6"),d.Sc(60),d.qc(61,"translate"),d.dc(),d.ec(62,"h5"),d.Zb(63,"img",23),d.Sc(64),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(65,"li",19),d.ec(66,"div",20),d.ec(67,"div",8),d.ec(68,"div",21),d.ec(69,"div",22),d.ec(70,"h6"),d.Sc(71),d.qc(72,"translate"),d.dc(),d.ec(73,"h5"),d.Sc(74),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc()),2&e){const e=d.pc();d.Mb(8),d.Tc(d.rc(9,15,"UPI_ID")),d.Mb(3),d.Uc("",e.DataService.selectedVpaDetailsPay.vpaDetails.paymentAddress," "),d.Mb(7),d.Tc(d.rc(19,17,"LINKED_ACCOUNT")),d.Mb(3),d.Uc("",e.DataService.selectedVpaDetailsPay.accountDetails.maskedAccountNumber," "),d.Mb(7),d.Tc(d.rc(29,19,"PAYEE_NAME")),d.Mb(3),d.Tc(e.DataService.payeeObj.payeeName),d.Mb(7),d.Tc(d.rc(39,21,"PAYEE_ACCOUNT")),d.Mb(3),d.Tc(e.DataService.payeeObj.payeeActNo),d.Mb(2),d.Tc(e.DataService.payeeObj.payeeIfsc),d.Mb(7),d.Tc(d.rc(51,23,"PAYEE_BANK")),d.Mb(3),d.Tc(e.DataService.payeeObj.payeeBankName?e.DataService.payeeObj.payeeBankName:"-"),d.Mb(7),d.Tc(d.rc(61,25,"AMOUNT")),d.Mb(4),d.Uc(" ",e.payeeAmt," "),d.Mb(7),d.Tc(d.rc(72,27,"REMARKS")),d.Mb(3),d.Tc(e.DataService.upiPayRequest.remarks?e.DataService.upiPayRequest.remarks:"-")}}const A=[{path:"",component:(()=>{class e{constructor(e,c,a,t,i,s,r,d,n,o,p,l){this.router=e,this.DataService=c,this.http=a,this.constant=t,this.localStorage=i,this.npciAndroidService=s,this.npciIosService=r,this.location=d,this.scanQrAmtService=n,this.ngZone=o,this.loaderService=p,this.commonMethods=l,this.headerdata={headerType:"TitleClose",titleName:"CONFIRMATION",footertype:"none"},this.payErrorMsg=""}ngOnInit(){this.DataService.changeMessage(this.headerdata),history.pushState({},"scanQRPayment",this.location.prepareExternalUrl("scanQRPayment")),history.pushState({},"self",this.location.prepareExternalUrl(this.router.url)),this.payeeAmt=this.DataService.upiPayRequest.amount.trim().replace(/[^.0-9]+/g,""),this.QRScanData=this.DataService.ScanQrCodeData}onClickPayAmount(){let e=this.DataService.selectedVpaDetailsPay.accountDetails;var c=(this.DataService.upiPayRequest.amount.trim().replace(/[^.0-9]+/g,"")?parseFloat(this.DataService.upiPayRequest.amount.trim().replace(/[^.0-9]+/g,"")):0)+(this.DataService.upiPayRequest.enTipAmount.trim().replace(/[^.0-9]+/g,"")?parseFloat(this.DataService.upiPayRequest.enTipAmount.trim().replace(/[^.0-9]+/g,"")):0);this.DataService.validateAddressResp.payAmount=this.DataService.upiPayRequest.amount.trim().replace(/[^.0-9]+/g,""),this.DataService.upiPayModelObj.payerAddr=this.DataService.selectedVpaDetailsPay.vpaDetails.paymentAddress?this.DataService.selectedVpaDetailsPay.vpaDetails.paymentAddress:"",this.DataService.upiPayModelObj.payeeAddr=this.DataService.payeeObj.payeeUpiAddress?this.DataService.payeeObj.payeeUpiAddress:"",this.DataService.upiPayModelObj.txnAmount=c.toFixed(2),this.DataService.upiPayModelObj.payeeName=this.DataService.payeeObj.payeeName?this.DataService.payeeObj.payeeName:"",this.DataService.upiPayModelObj.payeeIfsc=this.DataService.validateAddressResp.IFSC?this.DataService.payeeObj.payeeIfsc:"",console.log("this.QRScanData"),console.log(this.QRScanData),this.QRScanData.tid?(this.npciAndroidService.transactionId=this.QRScanData.tid,this.npciIosService.txnId=this.QRScanData.tid,this.DataService.payReceiptTransId=this.QRScanData.tid):this.npciAndroidService.getTransactionId().subscribe(e=>{this.npciAndroidService.transactionId=e,this.npciIosService.txnId=e,this.DataService.payReceiptTransId=e}),e.isSelected&&e.ifsc.includes("PSIB")?(this.DataService.preApprovedFlowIdentifier="scanQr",this.DataService.preApprovedBankName=e.bankName,this.DataService.preApprovedAccNo=e.maskedAccountNumber,this.DataService.preApprovedAmount=this.DataService.upiPayModelObj.txnAmount,this.DataService.preApprovedPreviousPageUrl=this.router.url,this.router.navigateByUrl("/transactionPin")):(console.log("SCAN QR PAYMENT => this.DataService.selectedFlow = ",this.DataService.selectedFlow),this.callNpciLibrary(e,this.DataService.selectedFlow))}checkTransactionId(){var e=new s.a;return this.DataService.platform.toLowerCase()==this.constant.val_android?this.QRScanData.tid?(this.npciAndroidService.transactionId=this.QRScanData.tid,this.DataService.payReceiptTransId=this.QRScanData.tid,e.next(!0),e.complete()):this.npciAndroidService.getTransactionId().subscribe(c=>{this.npciAndroidService.transactionId=c,this.DataService.payReceiptTransId=c,e.next(!0),e.complete()},c=>{e.next(!1),e.complete()}):this.DataService.platform.toLowerCase()==this.constant.val_ios?this.QRScanData.tid?(this.npciIosService.txnId=this.QRScanData.tid,this.DataService.payReceiptTransId=this.QRScanData.tid,e.next(!0),e.complete()):this.npciIosService.getTransactionId().subscribe(c=>{this.npciIosService.txnId=c,this.DataService.payReceiptTransId=c,e.next(!0),e.complete()},c=>{e.next(!1),e.complete()}):console.log("Unknown platform..."),e.asObservable()}callNpciLibrary(e,c){if(console.log("calling npci library..."),this.loaderService.showLoader(),window.hasOwnProperty("cordova"))if(this.DataService.platform.toLowerCase()==this.constant.val_android){console.log("Calling NPCI Android service..."),this.npciAndroidService.initData(),this.npciAndroidService.selectedFlow=c;var a=new s.a;this.npciAndroidService.androidStartCLLibrary(e,this.constant.val_npci_flow_sendMoney_android,a).subscribe(e=>{console.log("Android StartCLLibrary Success => ",e),e.hasOwnProperty("status")&&"00"==e.status&&this.payAmount(e)},e=>{console.log("Android StartCLLibrary error => ",e)})}else if(this.DataService.platform.toLowerCase()==this.constant.val_ios){console.log("Calling NPCI iOS service..."),this.npciIosService.initData(),this.npciIosService.selectedFlow=c;let a=new s.a;this.npciIosService.iosStartCLLibrary(e,this.constant.val_npci_flow_sendMoney_ios,a).subscribe(e=>{console.log("iOS StartCLLibrary Success => ",e),e&&e.credkey?this.payAmount(e):console.log("NPCI flow cancelled...")},e=>{console.log("iOS StartCLLibrary error => ",e)})}else showToastMessage("Unsupported Platform Try After Some Time!","error"),console.log("unknown platform = ",this.DataService.platform);else console.log("Cordova not available... unable to start NPCI Library on web")}payAmount(e){var c=r().format("YYYY-MM-DD"),a=r.duration(r().format("HH:mm"),"minutes"),t=r.duration(r(this.DataService.upiPayRequest.time).format("HH:mm"),"minutes"),i=r(this.DataService.upiPayRequest.date).format("YYYY-MM-DD"),s=r(i).diff(c,"minutes"),d=r.duration(t,"minutes").subtract(a).minutes();this.DataService.upiPayRequest.expiryTime=(s+d).toString();let n=this.getSelectedVpaAccountDetails();var o=this.scanQrAmtService.setPaymentRequest(n,this.DataService.payeeObj,e,this.QRScanData);this.UpiApiCall(o,e)}UpiApiCall(e,c){this.http.callBankingAPIService(e,this.localStorage.getLocalStorage(this.constant.storage_deviceId),this.constant.upiserviceName_PROCESSUPISERVICESESSION,!0).subscribe(e=>{let a=e.responseParameter.upiResponse;if(this.DataService.upiCallTransactionHistoryApi=!0,"00"==a.status)switch(a.subActionId){case this.constant.upiserviceName_FUNDSTRANSFER:this.setDetails(a,c),this.DataService.routeWithNgZone("scanQRSuccess")}else this.setDetails(a,c),this.DataService.routeWithNgZone("scanQRSuccess")},e=>{console.log("ERROR!",e)})}setDetails(e,c){this.DataService.payReceiptObj=e,this.DataService.payReceiptObj.remarks=this.DataService.upiPayRequest.remarks,this.DataService.payReceiptObj.amount=this.DataService.upiPayModelObj.txnAmount,this.DataService.payReceiptObj.payeeName=this.DataService.payeeObj.payeeName,this.DataService.payReceiptObj.payeeUpiAddress=this.DataService.payeeObj.payeeUpiAddress,this.DataService.payReceiptObj.payeeBankName=this.DataService.payeeObj.payeeBankName,this.DataService.payReceiptObj.payeeIfsc=this.DataService.payeeObj.payeeIfsc,this.DataService.payReceiptObj.payeeActNo=this.DataService.payeeObj.payeeActNo,this.DataService.payReceiptObj.selectedVpa=this.DataService.selectedVpaDetailsPay,this.DataService.payReceiptObj.refURL=this.DataService.ScanQrCodeData.url}getSelectedVpaAccountDetails(){let e=this.DataService.upiPayVpaList.find(e=>1==e.isSelected);if(e){let c=this.getSelectedAccountNoByVpa(e.accounts);return this.scanQrAmtService.selectedVpa={vpaDetails:e,accountDetails:c},{vpaDetails:e,accountDetails:c}}}getSelectedAccountNoByVpa(e){if(e.length>0)return e.find(e=>1==e.isSelected)}routePage(e){this.router.navigateByUrl(e)}}return e.\u0275fac=function(c){return new(c||e)(d.Yb(i.c),d.Yb(n.a),d.Yb(o.a),d.Yb(p.a),d.Yb(l.a),d.Yb(v.a),d.Yb(S.a),d.Yb(t.n),d.Yb(h.a),d.Yb(d.H),d.Yb(u.a),d.Yb(y.a))},e.\u0275cmp=d.Sb({type:e,selectors:[["app-scan-Qr-confirmation"]],decls:24,vars:5,consts:[[1,"main"],[1,"right-main-column","minus-rt-col","mar-custom"],[1,"right-col-container","cust-pb"],[1,"body-page-container"],[1,"container-fluid"],[1,"row"],[1,"bg-section"],[1,"col-12"],[1,"row1"],[1,"col-sm-12","col-12","col-md-12"],["class","white-bg1 pad-custom",4,"ngIf"],[1,"footer-container","sticky-actions"],[1,"footer-inactions","minus-rt-col"],[1,"col-12","col-md-12","col-lg-12","text-center"],[1,"ux-button","primary","md",3,"click"],[1,"powered-logo"],["src","assets/images/logo/powered-upi-logo.svg","alt","powered-upi-logo"],[1,"white-bg1","pad-custom"],[1,"complaint-list"],[1,"bor-n"],[1,"full-container"],[1,"col-12","col-md-12"],[1,"left-info"],["src","assets/images/svg/rupee-bl.svg","alt","rupees-icon"]],template:function(e,c){1&e&&(d.ec(0,"div",0),d.ec(1,"div",1),d.ec(2,"div",2),d.ec(3,"div",3),d.ec(4,"div",4),d.ec(5,"div",5),d.ec(6,"div",6),d.ec(7,"div",7),d.ec(8,"div",8),d.ec(9,"div",9),d.Rc(10,b,64,27,"div",10),d.Rc(11,m,75,29,"div",10),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.ec(12,"div",11),d.ec(13,"div",12),d.ec(14,"div",4),d.ec(15,"div",5),d.ec(16,"div",13),d.ec(17,"button",14),d.lc("click",(function(){return c.onClickPayAmount()})),d.Sc(18),d.qc(19,"translate"),d.dc(),d.dc(),d.dc(),d.ec(20,"div",5),d.ec(21,"div",13),d.ec(22,"div",15),d.Zb(23,"img",16),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc(),d.dc()),2&e&&(d.Mb(10),d.uc("ngIf","UPI_ID"==c.QRScanData.payType),d.Mb(1),d.uc("ngIf","BNK_ACT"==c.QRScanData.payType),d.Mb(7),d.Tc(d.rc(19,3,"PAY_NOW")))},directives:[t.t],pipes:[D.a],styles:[""]}),e})()}];let g=(()=>{class e{}return e.\u0275mod=d.Wb({type:e}),e.\u0275inj=d.Vb({factory:function(c){return new(c||e)},imports:[[i.g.forChild(A)],i.g]}),e})();var R=a("PCNd");let f=(()=>{class e{}return e.\u0275mod=d.Wb({type:e}),e.\u0275inj=d.Vb({factory:function(c){return new(c||e)},imports:[[t.c,R.a,g]]}),e})()}}]);