(window.webpackJsonp=window.webpackJsonp||[]).push([[287],{wC51:function(e,t,c){"use strict";c.r(t),c.d(t,"PmsbyAuthorizationModule",(function(){return x}));var o=c("PCNd"),i=c("3Pt+"),s=c("ofXK"),r=c("PqYM"),n=c("fXoL"),d=c("tyNb"),a=c("EnSQ"),p=c("L7Xq"),u=c("H9Rt"),m=c("5IsW"),l=c("fHQ/"),h=c("au7T"),v=c("CgMK"),b=c("goA9"),g=c("fUdP"),y=c("Eioz");const S=["pmsbyOTPRow"];function f(e,t){if(1&e){const e=n.fc();n.ec(0,"li"),n.ec(1,"a",68),n.lc("click",(function(){n.Hc(e);const c=t.$implicit;return n.pc().DataService.breadcrumroute(c.routeName)})),n.Sc(2),n.qc(3,"translate"),n.dc(),n.dc()}if(2&e){const e=t.$implicit;n.Mb(2),n.Tc(n.rc(3,1,e.currentRoute))}}function w(e,t){1&e&&(n.ec(0,"p",69),n.Sc(1," Please enter valid OTP "),n.dc())}const D=[{path:"",component:(()=>{class e{constructor(e,t,c,o,i,s,r,n,d){this.router=e,this.DataService=t,this.http=c,this.storage=o,this.constant=i,this.location=s,this.encryptDecryptService=r,this.commonMethod=n,this.nomineeAuthorizationService=d,this.counter=120,this.tick=1e3,this.invalidOtp=!1,this.pmsbyOtpInput=["otp1","otp2","otp3","otp4","otp5","otp6"]}ngOnInit(){this.buildForm(),this.DataService.setPageSettings("pmsby Auth"),this.DataService.setShowThemeObservable(!0),this.DataService.setShowsideNavObservable(!0),this.DataService.setShowNotificationObservable(!0),this.DataService.getBreadcrumb("AUTHORIZATION",this.router.url),this.resendOTP(1),this.overviewDetails=this.DataService.pmsbyDetailsOverviewObj,this.mobNumber=this.maskCharacter(this.storage.getLocalStorage(this.constant.storage_mobileNo),4),history.pushState({},"pmsbyOverview",this.location.prepareExternalUrl("pmsbyOverview")),history.pushState({},"self",this.location.prepareExternalUrl(this.router.url))}buildForm(){this.pmsbyForm=new i.j({otp1:new i.g("",[i.G.required,i.G.maxLength(1)]),otp2:new i.g("",[i.G.required,i.G.maxLength(1)]),otp3:new i.g("",[i.G.required,i.G.maxLength(1)]),otp4:new i.g("",[i.G.required,i.G.maxLength(1)]),otp5:new i.g("",[i.G.required,i.G.maxLength(1)]),otp6:new i.g("",[i.G.required,i.G.maxLength(1)])})}validateForm(){if(this.pmsbyForm.invalid)return this.pmsbyForm.get("otp1").markAsTouched(),this.pmsbyForm.get("otp2").markAsTouched(),this.pmsbyForm.get("otp3").markAsTouched(),this.pmsbyForm.get("otp4").markAsTouched(),this.pmsbyForm.get("otp5").markAsTouched(),void this.pmsbyForm.get("otp6").markAsTouched()}onKeyUpEvent(e,t,c){var o;const i=t.which||t.keyCode;1===this.getSpasswordElement(e,c).value.length&&(7!==e?this.getSpasswordElement(e+1,c).focus():(this.getSpasswordElement(e,c).blur(),console.log("submit code "))),12===i&&1!==e&&this.getSpasswordElement(e-1,c).focus(),8!==i&&229!==i||"Unidentified"!=t.key&&("otp"==c&&(null===(o=this.pmsbyForm.get(this.pmsbyOtpInput[e]))||void 0===o||o.setValue("")),this.getSpasswordElement(e-1,c).focus())}onFocusEvent(e,t){for(let c=1;c<e;c++){const e=this.getSpasswordElement(c,t);if(!e.value){e.focus();break}}}getSpasswordElement(e,t){if("otp"==t)return this.pmsbyRows._results[e].nativeElement}goToPage(e){this.router.navigateByUrl("/"+e)}pmsbySubmit(){let e;if(this.pmsbyForm.valid){e=this.pmsbyForm.value.otp1+this.pmsbyForm.value.otp2+this.pmsbyForm.value.otp3+this.pmsbyForm.value.otp4+this.pmsbyForm.value.otp5+this.pmsbyForm.value.otp6;var t=this.nomineeAuthorizationService.getSendOTPSessionReq(e);this.submitOtpSession(t)}else this.validateForm()}submitOtpSession(e){console.log("this.DataService.request"+this.DataService.request),this.tempDecryptedReq=JSON.parse(this.encryptDecryptService.decryptText(this.storage.getSessionStorage(this.constant.val_sessionKey),this.DataService.request)),console.log("nominee auth ",this.tempDecryptedReq),console.log(this.tempDecryptedReq),this.tempDecryptedReq.methodName=this.DataService.endPoint.split("/")[1],this.tempDecryptedReq.value=this.pmsbyForm.value.otp1+this.pmsbyForm.value.otp2+this.pmsbyForm.value.otp3+this.pmsbyForm.value.otp4+this.pmsbyForm.value.otp5+this.pmsbyForm.value.otp6,this.tempDecryptedReq.customerID=this.DataService.userDetails.customerId,this.tempDecryptedReq.amount=this.tempDecryptedReq.amount+"00",console.log(this.tempDecryptedReq);let t=this.encryptDecryptService.encryptText(this.storage.getSessionStorage(this.constant.val_sessionKey),JSON.stringify(this.tempDecryptedReq));this.DataService.request=t,console.log(this.DataService.request),this.submitReq()}submitReq(){console.log("this.DataService.request"+this.DataService.request),this.http.callBankingAPIService(this.DataService.request,this.storage.getLocalStorage(this.constant.storage_deviceId),this.DataService.endPoint).subscribe(e=>{switch(console.log(e),this.pmsbyForm.reset(),e.responseParameter.opstatus){case this.constant.val_InvalidCredentials:break;case"03":this.DataService.isOTPMaxAttempts=!0;break;case"11":this.invalidOtp=!0;break;case"12":this.DataService.isOTPMaxAttempts=!0,this.commonMethod.openPopup("div.popup-bottom.otp-attempt-expired");break;default:"00"==e.responseParameter.opstatus?(console.log(e),this.DataService.receiptType="Successful"):this.DataService.receiptType="Failed",this.DataService.receiptmsg=e.responseParameter.Result,this.DataService.receipdRefID=""==e.RRN?"-":e.RRN,this.router.navigate(["/pmsbyReceipt"])}})}resendOTP(e){this.pmsbyForm.reset();var t=this.nomineeAuthorizationService.getResendOTPSessionReq("PMSBY Enrollment");this.http.callBankingAPIService(t,this.storage.getLocalStorage(this.constant.storage_deviceId),this.constant.serviceName_RESENDOTPSESSION).subscribe(t=>{"00"==t.responseParameter.opstatus&&(this.startCounter(),2==e&&showToastMessage(t.responseParameter.Result,"success"))})}maskCharacter(e,t){return(""+e).slice(0,-t).replace(/./g,"*")+(""+e).slice(-t)}startCounter(){this.tick=1e3,this.counter=120,this.countDown&&!this.countDown.closed&&this.countDown.unsubscribe(),this.countDown=Object(r.a)(0,this.tick).subscribe(()=>{1==this.counter&&this.countDown.unsubscribe(),--this.counter})}closePopup(e){this.commonMethod.closePopup(e),this.router.navigateByUrl("/pmsbyDetails")}}return e.\u0275fac=function(t){return new(t||e)(n.Yb(d.c),n.Yb(a.a),n.Yb(p.a),n.Yb(u.a),n.Yb(m.a),n.Yb(s.n),n.Yb(l.a),n.Yb(h.a),n.Yb(v.a))},e.\u0275cmp=n.Sb({type:e,selectors:[["app-pmsby-authorization"]],viewQuery:function(e,t){var c;1&e&&n.Yc(S,!0),2&e&&n.Dc(c=n.mc())&&(t.pmsbyRows=c)},decls:154,vars:17,consts:[[1,"main","bg-m"],[1,"right-main-column"],[1,"right-col-container","pad-b","full-width"],[1,"body-page-container","main-dashborad","manage-payee"],[1,"container-fluid"],[1,"row"],[1,"col-12","p-0"],[1,"breadcrumb"],[1,"lst-breadcrumb"],[4,"ngFor","ngForOf"],[1,"vspacer15","customize","d-none","d-md-block","d-lg-block","d-xl-block"],[1,"row","no-gutters"],[1,"col-12"],[1,"row1"],[1,"col-12","col-sm-12","col-md-12","col-lg-12","col-xl-9"],[1,"greencard2"],[1,"row1","hide-m"],[1,"col-md-8","col-12"],[1,"col-md-4","col-12"],[1,"col-sm-12","col-12","col-md-12"],[1,"white-box2","mar-t","pad-custom","custom-bor"],[1,"col-12","col-md-8","col-lg-9","col-xl-9"],[1,"col-12","col-md-12"],[1,"ux-input"],[1,"info-message2"],[1,"col-12","col-md-8","col-lg-8","col-xl-7"],[1,"col-12","pl-2","pr-2"],[3,"formGroup"],[1,"row3"],[1,"col-sm-2","col-2","col-md-2"],[1,"ux-input","password1","mb-1"],["id","otppassword1","type","password","maxlength","1","placeholder","\u25cf","formControlName","otp1",3,"keyup","focus"],["pmsbyOTPRow",""],["id","otppassword2","type","password","maxlength","1","placeholder","\u25cf","formControlName","otp2",3,"keyup","focus"],["id","otppassword3","type","password","maxlength","1","placeholder","\u25cf","formControlName","otp3",3,"keyup","focus"],["id","otppassword4","type","password","maxlength","1","placeholder","\u25cf","formControlName","otp4",3,"keyup","focus"],["id","otppassword5","type","password","maxlength","1","placeholder","\u25cf","formControlName","otp5",3,"keyup","focus"],["id","otppassword6","type","password","maxlength","1","placeholder","\u25cf","formControlName","otp6",3,"keyup","focus"],[1,"ux-input","password1","mt-0","mb-0"],["class","error-message",4,"ngIf"],[1,"col-6","col-md-6"],[1,"text-left"],[1,"success-text"],[1,"text-right"],[1,"ux-linkbutton","default-underline","mt3",3,"ngClass","click"],[1,"col-12","col-md-4","col-lg-3","col-xl-3","text-right","hide-m"],[1,"mobile-img"],["src","assets/images/icons/mobile.svg","alt","mobile-icon"],[1,"result-container1","mar-top"],[1,"info-bottom","pad-custom"],[1,"info-details","mt-3"],[1,"info-details"],[1,"col-md-12","col-xl-12","col-lg-12","col-12"],[1,"bottom-footer1"],[1,"btn-div"],[1,"ux-button","secondary","sm-mob",3,"click"],[1,"ux-button","primary","sm-mob",3,"click"],[1,"col-12","col-md-12","col-lg-12","col-xl-3","d-none","d-xl-block"],[1,"right-ads"],["src","assets/images/banner/my-card-banner.jpg"],[1,"vspacer30"],[1,"popup-bottom","sm-popup","otp-attempt-expired"],[1,"text-center"],["src","assets/images/svg/success.svg","alt","success-icon"],[1,"col-12","mb-4"],[1,"row1","mt-2"],[1,"col-12","text-center"],[1,"ux-button","primary","submit-btn",3,"click"],[3,"click"],[1,"error-message"]],template:function(e,t){1&e&&(n.ec(0,"div",0),n.ec(1,"div",1),n.ec(2,"div",2),n.ec(3,"div",3),n.ec(4,"div",4),n.ec(5,"div",5),n.ec(6,"div",6),n.ec(7,"div",7),n.ec(8,"ul",8),n.Rc(9,f,4,3,"li",9),n.dc(),n.dc(),n.dc(),n.dc(),n.Zb(10,"div",10),n.ec(11,"div",11),n.ec(12,"div",12),n.ec(13,"div",13),n.ec(14,"div",14),n.ec(15,"div",15),n.ec(16,"div",16),n.ec(17,"div",17),n.ec(18,"h4"),n.Sc(19,"Enter OTP"),n.dc(),n.dc(),n.Zb(20,"div",18),n.dc(),n.ec(21,"div",13),n.ec(22,"div",19),n.ec(23,"div",20),n.ec(24,"div",13),n.ec(25,"div",21),n.ec(26,"div",13),n.ec(27,"div",22),n.ec(28,"div",23),n.ec(29,"em",24),n.Sc(30),n.dc(),n.dc(),n.dc(),n.ec(31,"div",25),n.ec(32,"div",5),n.ec(33,"div",26),n.ec(34,"form",27),n.ec(35,"div",28),n.ec(36,"div",29),n.ec(37,"div",30),n.ec(38,"input",31,32),n.lc("keyup",(function(e){return t.onKeyUpEvent(0,e,"otp")}))("focus",(function(){return t.onFocusEvent(0,"otp")})),n.dc(),n.dc(),n.dc(),n.ec(40,"div",29),n.ec(41,"div",30),n.ec(42,"input",33,32),n.lc("keyup",(function(e){return t.onKeyUpEvent(1,e,"otp")}))("focus",(function(){return t.onFocusEvent(1,"otp")})),n.dc(),n.dc(),n.dc(),n.ec(44,"div",29),n.ec(45,"div",30),n.ec(46,"input",34,32),n.lc("keyup",(function(e){return t.onKeyUpEvent(2,e,"otp")}))("focus",(function(){return t.onFocusEvent(2,"otp")})),n.dc(),n.dc(),n.dc(),n.ec(48,"div",29),n.ec(49,"div",30),n.ec(50,"input",35,32),n.lc("keyup",(function(e){return t.onKeyUpEvent(3,e,"otp")}))("focus",(function(){return t.onFocusEvent(3,"otp")})),n.dc(),n.dc(),n.dc(),n.ec(52,"div",29),n.ec(53,"div",30),n.ec(54,"input",36,32),n.lc("keyup",(function(e){return t.onKeyUpEvent(4,e,"otp")}))("focus",(function(){return t.onFocusEvent(4,"otp")})),n.dc(),n.dc(),n.dc(),n.ec(56,"div",29),n.ec(57,"div",30),n.ec(58,"input",37,32),n.lc("keyup",(function(e){return t.onKeyUpEvent(5,e,"otp")}))("focus",(function(){return t.onFocusEvent(5,"otp")})),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.ec(60,"div",13),n.ec(61,"div",12),n.ec(62,"div",38),n.Rc(63,w,2,0,"p",39),n.dc(),n.dc(),n.dc(),n.ec(64,"div",28),n.ec(65,"div",40),n.ec(66,"div",41),n.ec(67,"p",41),n.ec(68,"span",42),n.Sc(69),n.qc(70,"formatTimer"),n.dc(),n.dc(),n.dc(),n.dc(),n.ec(71,"div",40),n.ec(72,"div",43),n.ec(73,"button",44),n.lc("click",(function(){return t.resendOTP(2)})),n.Sc(74,"RESEND"),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.ec(75,"div",45),n.ec(76,"div",46),n.Zb(77,"img",47),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.ec(78,"div",19),n.ec(79,"div",48),n.ec(80,"div",49),n.ec(81,"div",50),n.ec(82,"div",5),n.ec(83,"h6"),n.Sc(84,"Scheme"),n.dc(),n.ec(85,"h5"),n.Sc(86),n.dc(),n.dc(),n.dc(),n.ec(87,"div",51),n.ec(88,"div",5),n.ec(89,"h6"),n.Sc(90,"Name"),n.dc(),n.ec(91,"h5"),n.Sc(92),n.dc(),n.dc(),n.dc(),n.ec(93,"div",51),n.ec(94,"div",5),n.ec(95,"h6"),n.Sc(96,"Date of Birth"),n.dc(),n.ec(97,"h5"),n.Sc(98),n.dc(),n.dc(),n.dc(),n.ec(99,"div",51),n.ec(100,"div",5),n.ec(101,"h6"),n.Sc(102,"Nominee Name"),n.dc(),n.ec(103,"h5"),n.Sc(104),n.dc(),n.dc(),n.dc(),n.ec(105,"div",51),n.ec(106,"div",5),n.ec(107,"h6"),n.Sc(108," Debit Account "),n.dc(),n.ec(109,"h5"),n.Sc(110),n.dc(),n.dc(),n.dc(),n.ec(111,"div",51),n.ec(112,"div",5),n.ec(113,"h6"),n.Sc(114,"Date of Enrollment "),n.dc(),n.ec(115,"h5"),n.Sc(116),n.dc(),n.dc(),n.dc(),n.ec(117,"div",51),n.ec(118,"div",5),n.ec(119,"h6"),n.Sc(120," Premium Amount "),n.dc(),n.ec(121,"h5"),n.Sc(122),n.qc(123,"customcurrency"),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.ec(124,"div",22),n.ec(125,"div",13),n.ec(126,"div",52),n.ec(127,"ul",53),n.ec(128,"li"),n.ec(129,"div",54),n.ec(130,"button",55),n.lc("click",(function(){return t.goToPage("pmsbyOverview")})),n.Sc(131,"Cancel"),n.dc(),n.dc(),n.ec(132,"div",54),n.ec(133,"button",56),n.lc("click",(function(){return t.pmsbySubmit()})),n.Sc(134,"Continue"),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.ec(135,"div",57),n.ec(136,"div",58),n.ec(137,"a"),n.Zb(138,"img",59),n.dc(),n.dc(),n.Zb(139,"div",60),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.dc(),n.ec(140,"div",61),n.ec(141,"div",13),n.ec(142,"div",12),n.ec(143,"h4",62),n.Zb(144,"img",63),n.Sc(145," Information "),n.dc(),n.dc(),n.dc(),n.ec(146,"div",13),n.ec(147,"div",64),n.ec(148,"p"),n.Sc(149," You have reached your maximum attempt.Please try again "),n.dc(),n.dc(),n.dc(),n.ec(150,"div",65),n.ec(151,"div",66),n.ec(152,"button",67),n.lc("click",(function(){return t.closePopup("div.popup-bottom.otp-attempt-expired")})),n.Sc(153,"OK"),n.dc(),n.dc(),n.dc(),n.dc()),2&e&&(n.Mb(9),n.uc("ngForOf",t.DataService.breadcrumblist),n.Mb(21),n.Uc("OTP sent on your registered Mobile number ending with ",t.mobNumber,""),n.Mb(4),n.uc("formGroup",t.pmsbyForm),n.Mb(29),n.uc("ngIf",t.invalidOtp),n.Mb(6),n.Tc(n.rc(70,13,t.counter)),n.Mb(4),n.uc("ngClass",t.counter>0?"mydisabled":"resendActive"),n.Mb(13),n.Tc(t.overviewDetails.scheme),n.Mb(6),n.Tc(t.overviewDetails.name),n.Mb(6),n.Tc(t.overviewDetails.dob),n.Mb(6),n.Tc(t.overviewDetails.nomineeName),n.Mb(6),n.Tc(t.overviewDetails.debitAccount),n.Mb(6),n.Tc(t.overviewDetails.dateOfEnrollment),n.Mb(6),n.Tc(n.rc(123,15,t.overviewDetails.premiumAmount)))},directives:[s.s,i.I,i.t,i.k,i.c,i.n,i.s,i.i,s.t,s.q],pipes:[b.c,g.a,y.a],styles:[""]}),e})()}];let k=(()=>{class e{}return e.\u0275mod=n.Wb({type:e}),e.\u0275inj=n.Vb({factory:function(t){return new(t||e)},imports:[[d.g.forChild(D)],d.g]}),e})(),x=(()=>{class e{}return e.\u0275mod=n.Wb({type:e}),e.\u0275inj=n.Vb({factory:function(t){return new(t||e)},imports:[[s.c,k,i.m,i.C,o.a]]}),e})()}}]);